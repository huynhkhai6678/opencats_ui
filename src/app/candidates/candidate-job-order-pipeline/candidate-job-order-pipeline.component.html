@let contactList = activities.value() || [];

<div class="flex direction-end mt-2 justify-end">
    <p-button label="Add Candidate To Pipeline" class="me-2" (onClick)="create()"/>
</div>

<div class="mt-4">
    <p-table
        [value]="contactList"
        [lazy]="false"
        [paginator]="false"
    >
        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="rating_value">
                    <div class="flex items-center gap-2">
                        Match
                        <p-sortIcon field="rating_value"></p-sortIcon>
                    </div>
                </th>
                <th pSortableColumn="joborder.title">
                    <div class="flex items-center gap-2">
                        Title
                        <p-sortIcon field="joborder.title"></p-sortIcon>
                    </div>
                </th>
                <th pSortableColumn="joborder.company.name">
                    <div class="flex items-center gap-2">
                        Company
                        <p-sortIcon field="oborder.company.name"></p-sortIcon>
                    </div>
                </th>
                <th pSortableColumn="joborder.company.owner_user.first_name">
                    <div class="flex items-center gap-2">
                        Owner
                        <p-sortIcon field="joborder.company.owner_user.first_name"></p-sortIcon>
                    </div>
                </th>
                <th pSortableColumn="candidate.entered_user.name">
                    <div class="flex items-center gap-2">
                        Last Update
                        <p-sortIcon field="candidate.entered_user.name"></p-sortIcon>
                    </div>
                </th>
                <th pSortableColumn="candidate.entered_user.name">
                    <div class="flex items-center gap-2">
                        Headhunt
                        <p-sortIcon field="candidate.entered_user.name"></p-sortIcon>
                    </div>
                </th>
                <th pSortableColumn="status_info.short_description">
                    <div class="flex items-center gap-2">
                        Status
                        <p-sortIcon field="status_info.short_description"></p-sortIcon>
                    </div>
                </th>
                <th >
                    <div class="flex items-center gap-2">
                        Action
                    </div>
                </th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-row>
            <tr>
                <td>
                    <p-rating [(ngModel)]="row.rating_value" (onRate)="onRating($event, row.candidate_joborder_id)"/>
                </td>
                <td>
                    <p-button class="link-btn" label="{{row.joborder.title}}" link routerLink="/home/job-orders/{{row.joborder_id}}"/>
                </td>
                 <td>
                    <p-button class="link-btn" label="{{row.joborder.company.name}}" link routerLink="/home/companies/{{row.joborder.company_id}}"/>
                </td>
                <td>
                    {{ row.joborder?.company?.owner_user?.first_name }} {{ row.joborder?.company?.owner_user?.last_name }}
                </td>
                <td>
                    {{ row.date_created | date : "dd/MM/yyyy" }}
                </td>
                <td>
                    {{ row.candidate?.entered_user?.name }}
                </td>
                <td>
                    {{ row.status_info?.short_description }}
                </td>
                <td>
                    <div class="flex gap-2">
                        <p-button severity="info" (onClick)="edit(row.candidate_joborder_id)">
                            <fa-icon [icon]="faPencil"></fa-icon>
                        </p-button>
                        <p-button severity="danger" (onClick)="deletePipeline($event, row.candidate_joborder_id)">
                            <fa-icon [icon]="faTrash"></fa-icon>
                        </p-button>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<app-job-order-pipeline-modal #pipelineModal (reloadTable)="reload()"></app-job-order-pipeline-modal>
<app-pipeline-modal #pipelineModal (reloadTable)="reload()"></app-pipeline-modal>