<div class="mx-auto p-6 lg:px-8">
    <div class="mt-2">
        <h2 class="text-2xl font-bold">Companies: Home</h2>
    </div>
    <div class="flex direction-end mt-2 gap-2 justify-end">
        <p-button label="Export Companies" (onClick)="export()"/>
        <p-button label="Create Company" (onClick)="create()"/>
    </div>
    <div class="mt-2">
        <p-table
            [value]="records"
            [lazy]="true"
            [paginator]="true"
            [rows]="10"
            [totalRecords]="totalRecords"
            [loading]="loading"
            (onLazyLoad)="loadData($event)"
            [globalFilterFields]="['name', 'email']"
            [rowsPerPageOptions]="[10, 20, 50]"
        >
            <ng-template #caption>
                <div class="flex justify-between items-center">
                    <input pInputText type="text" (input)="onGlobalFilter($event)" placeholder="Search keyword" />
                    <div class="flex gap-4">
                        <div class="flex items-center">
                            <p-checkbox inputId="is_my_company" name="is_my_company" [binary]="true" [(ngModel)]="filterOptions.is_my_company" (onChange)="setFilter()"/>
                            <label for="is_my_company" class="ml-2">Only my companies</label>
                        </div>
                        <div class="flex items-center">
                            <p-checkbox inputId="is_hot_company" name="is_hot_company" [binary]="true" [(ngModel)]="filterOptions.is_hot_company" (onChange)="setFilter()"/>
                            <label for="is_hot_company" class="ml-2">Only hot companies</label>
                        </div>
                    </div>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th>
                        
                    </th>
                    <th pSortableColumn="name">
                        Name
                        <p-sortIcon field="name"></p-sortIcon>
                    </th>
                    <th pSortableColumn="jobs">
                        Jobs
                        <p-sortIcon field="jobs"></p-sortIcon>
                    </th>
                    <th pSortableColumn="city">
                        City
                        <p-sortIcon field="city"></p-sortIcon>
                    </th>
                    <th pSortableColumn="state">
                        State
                        <p-sortIcon field="state"></p-sortIcon>
                    </th>
                    <th pSortableColumn="phone1">
                        Phone
                        <p-sortIcon field="phone1"></p-sortIcon>
                    </th>
                    <th pSortableColumn="ownerFirstName">
                        Owner
                        <p-sortIcon field="ownerFirstName"></p-sortIcon>
                    </th>
                    <th pSortableColumn="date_created">
                        Created
                        <p-sortIcon field="date_created"></p-sortIcon>
                    </th>
                    <th pSortableColumn="date_modified">
                        Modified
                        <p-sortIcon field="date_modified"></p-sortIcon>
                    </th>
                    <th pSortableColumn="contactFirstName">
                        Contact
                        <p-sortIcon field="contactFirstName"></p-sortIcon>
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
                <tr>
                    <td>
                        @if (row.attachmentPresent) {
                            <fa-icon [icon]="faPaperclip"></fa-icon>
                        }
                    </td>
                    <td>
                        <p-button label="{{row.name}}" link routerLink="{{row.company_id}}"/>
                    </td>
                    <td>{{ row.jobs }}</td>
                    <td>{{ row.city }}</td>
                    <td>{{ row.state }}</td>
                    <td>{{ row.phone1 }}</td>
                    <td>{{ row.ownerFirstName }} {{row.ownerLastName}}</td>
                    <td>{{ row.date_created }}</td>
                    <td>{{ row.date_modified }}</td>
                    <td>{{ row.contactFirstName }} {{row.contactLastName}}</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>

<app-company-modal #companyModal (reloadTable)="reloadTable()"></app-company-modal>