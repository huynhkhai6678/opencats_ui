<div class="mx-auto p-6 lg:px-8">
    <div class="mt-2">
        <h2 class="text-2xl font-bold">Companies: Home</h2>
    </div>
    <div class="flex direction-end mt-2 gap-4 justify-end">
        <p-button label="Export Contacts" (onClick)="export()"/>
        <p-button label="Create Contact" (onClick)="create()"/>
    </div>
    <div class="mt-2">
        <p-table
            [value]="records"
            [lazy]="true"
            [paginator]="true"
            [rows]="10"
            [totalRecords]="totalRecords"
            [loading]="loading"
            (onLazyLoad)="loadData($event)"
            [globalFilterFields]="['name', 'email']"
            [rowsPerPageOptions]="[10, 20, 50]"
        >
            <ng-template #caption>
                <div class="flex">
                    <input pInputText type="text" (input)="onGlobalFilter($event)" placeholder="Search keyword" />
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="first_name">
                        First Name
                        <p-sortIcon field="first_name"></p-sortIcon>
                    </th>
                    <th pSortableColumn="last_name">
                        Last Name
                        <p-sortIcon field="last_name"></p-sortIcon>
                    </th>
                    <th pSortableColumn="companyName">
                        Company
                        <p-sortIcon field="companyName"></p-sortIcon>
                    </th>
                    <th pSortableColumn="title">
                        Title
                        <p-sortIcon field="title"></p-sortIcon>
                    </th>
                    <th pSortableColumn="phone_work">
                        Work Phone
                        <p-sortIcon field="phone_work"></p-sortIcon>
                    </th>
                    <th pSortableColumn="ownerFirstName">
                        Owner
                        <p-sortIcon field="ownerFirstName"></p-sortIcon>
                    </th>
                    <th pSortableColumn="date_created">
                        Created
                        <p-sortIcon field="date_created"></p-sortIcon>
                    </th>
                    <th pSortableColumn="date_modified">
                        Modified
                        <p-sortIcon field="date_modified"></p-sortIcon>
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
                <tr>
                    <td>
                        <p-button label="{{row.firstName}}" link routerLink="{{row.contactID}}"/>
                    </td>
                    <td>
                        <p-button label="{{row.lastName}}" link routerLink="{{row.contactID}}"/>
                    </td>
                    <td>
                        <p-button label="{{row.companyName}}" link routerLink="{{row.companyId}}"/>
                    </td>
                    <td>{{ row.title }}</td>
                    <td>{{ row.workPhone }}</td>
                    <td>{{ row.ownerFirstName }} {{row.ownerLastName}}</td>
                    <td>{{ row.dateCreatedSort | date : 'dd/MM/yyyy' }}</td>
                    <td>{{ row.dateModifiedSort | date : 'dd/MM/yyyy' }}</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>

<app-contact-modal #contactModal (reloadTable)="reloadTable()"></app-contact-modal>